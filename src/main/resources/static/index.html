<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Sign In</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
  <link rel="stylesheet" href="/css/styles.css">
</head> 

<body class="d-flex justify-content-center align-items-center vh-100">

  <div class="background">
      <img src="/images/logo.png" alt="GOPro Logo" class="logo">
  </div>

  <!-- Responsive card -->
  <div class="card shadow-lg border-0 rounded-4 p-4 fade-in w-100 position-relative"
       style="max-width: 800px; background: rgba(255,255,255,0.7); backdrop-filter: blur(12px);">

    <!-- Remove back arrow or update if needed -->
    <!-- <a href="/login.html" class="back-arrow position-absolute start-0 top-0 ms-3 mt-3 fs-4 text-secondary text-decoration-none">
      <i class="bi bi-arrow-left"></i>
    </a> -->

    <div class="row g-0 align-items-center">
      <!-- Left side (logo) -->
      <div class="col-md-6 d-flex flex-column align-items-center justify-content-center p-4 border-end">
        <div class="avatar-container">
          <img src="/images/logo.png" alt="PRO Logo"> <!-- fixed path -->
        </div>
        <h1 class="fw-semibold">Welcome Back</h1>
      </div>

      <!-- Right side (form) -->
      <div class="col-md-6 p-4">
        <h2 class="fw-semibold mb-4 text-center">Sign In</h2>
        <form action="http://localhost:8080/api/login" method="POST">
          <input type="email" name="email" class="form-control mb-3 rounded-pill" placeholder="Email" required>
          <input type="password" name="password" class="form-control mb-3 rounded-pill" placeholder="Password" required>
          <button type="submit" class="btn btn-primary w-100 rounded-pill fw-bold py-2">Sign In</button>
          <a href="#" class="d-block mt-3 text-decoration-none text-primary text-center">Forgot Password?</a>
          <a href="/new_user.html" class="d-block mt-3 text-decoration-none text-primary text-center">New User? Sign Up</a>
        </form>
      </div>
    </div>
  </div>

  <script>
const form = document.querySelector("form");
form.addEventListener("submit", async (e) => {
    e.preventDefault();
    const email = form.querySelector('input[name="email"]').value;
    const password = form.querySelector('input[name="password"]').value;

    const res = await fetch("/api/login", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ email, password })
    });

    const msg = await res.text();

    if (res.ok) {
        // Redirect to next page (create dashboard.html later)
        window.location.href = "/dashboard.html";
    } else {
        // Show error on the page
        let errorDiv = document.getElementById("error-message");
        if (!errorDiv) {
            errorDiv = document.createElement("div");
            errorDiv.id = "error-message";
            errorDiv.style.color = "red";
            errorDiv.style.marginTop = "10px";
            form.appendChild(errorDiv);
        }
        errorDiv.textContent = msg;
    }
});
</script>

</body>
</html>
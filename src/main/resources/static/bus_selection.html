<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bus Selection</title>
<link rel="stylesheet" href="/css/styles.css">
</head>
<body>
<h2>Available Buses</h2>
<div id="busList"></div>

<script>
const urlParams = new URLSearchParams(window.location.search);
const budget = parseFloat(urlParams.get('budget'));
const from = urlParams.get('from');
const to = urlParams.get('to');
const date = urlParams.get('date');

async function fetchBuses() {
  try {
    const res = await fetch(`/api/buses?budget=${budget}&from=${from}&to=${to}&date=${date}`);
    if (!res.ok) throw new Error('Failed to fetch buses');
    const buses = await res.json();
    const busListDiv = document.getElementById('busList');

    if (!buses || buses.length === 0) {
      busListDiv.innerHTML = `<p>No buses available within your budget.</p>`;
      return;
    }

    let html = '<ul>';
    buses.forEach(bus => {
      html += `<li>${bus.name} | From: ${bus.from} | To: ${bus.to} | Date: ${bus.date} | Price: â‚¹${bus.price}</li>`;
    });
    html += '</ul>';
    busListDiv.innerHTML = html;

  } catch (err) {
    console.error(err);
    alert('Error fetching buses.');
  }
}

fetchBuses();
</script>
</body>
</html>